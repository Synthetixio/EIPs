---
sip: 281
title: PerpsV2 (Trading fixes & improvements)
network: Optimism
status: Draft
type: Governance
author: David Vuong (@davidvuong)
implementor: David Vuong (@davidvuong)
created: 2022-09-30
requires: 280
---

## Simple Summary

Improves the underlying mechanism of next price orders to be time oriented and takes further consideration into maker/taker fee calculations when a trade flips the market skew.

## Abstract

SIP proposes two changes, (1) delayed orders and (2) cross side maker/taker fees. Delay orders replaces but incorporates next-price orders. In short, the execution of submitted async orders become executable on a time based rather than purely on a semi-arbitrary price feed update from CL.

Cross side maker/taker fees is a fix on the current order fee calculation. Currently, if an order flips the market skew, the order size in its entirety is charged with just maker fees. This change involves updating the calculation such that the the proportion of size that reduces the skew will be charged a maker fee but the remaining which increases the skew is charged with a taker fee.

Note this depends on SIP-280 to be complete as these changes extend on top of PerpsV2.

## Motivation

### Delayed Orders

Current next price orders are non-deterministic and creates a bad user experience for traders. An order is only executable when a new price update occurs. During times of low volatility, a price feed's deviation would never kick in and traders are at the mercy of the heartbeat.

If the intent is to minimise frontrunning, the same can be achieved through a time based delay. This provides a win-win-win scenario in that traders receive a better user experience as they have a higher level of confidence their trade will be fulfilled/fulfilled faster, while capitalising on lower fees, and the protocol sees the same benefit to frontrunning as in next price.

### Cross Side Maker/Taker Fees

Order fee calculations in the current state do not behave correctly in the scenario where a trade is both a maker and a taker. This can happen when the size of the trade pushes the market skew past equilibrium and into the opposing direction. As a result, fees are miscalculated because the proportion of size in the opposite direction is calculated against a maker fee when it should in fact be a taker fee.

## Specification

### Overview

This is a high level overview of _how_ the SIP will solve the problem. The overview should clearly describe how the new feature will be implemented.

### Rationale

This is where you explain the reasoning behind how you propose to solve the problem. Why did you propose to implement the change in this way, what were the considerations and trade-offs. The rationale fleshes out what motivated the design and why particular design decisions were made. It should describe alternate designs that were considered and related work. The rationale may also provide evidence of consensus within the community, and should discuss important objections or concerns raised during discussion.

### Technical Specification

The technical specification should outline the public API of the changes proposed. That is, changes to any of the interfaces Synthetix currently exposes or the creations of new ones.

### Test Cases

Test cases for an implementation are mandatory for SIPs but can be included with the implementation.

### Configurable Values (Via SCCP)

Please list all values configurable via SCCP under this implementation.

## Copyright

Copyright and related rights waived via [CC0](https://creativecommons.org/publicdomain/zero/1.0/).
